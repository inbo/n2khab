<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with geospatial data sources of habitat (sub)types and RIBs • n2khab</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Working with geospatial data sources of habitat (sub)types and RIBs">
<meta property="og:description" content="n2khab">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">n2khab</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v010_reference_lists.html">Reference lists and using them</a>
    </li>
    <li>
      <a href="../articles/v020_datastorage.html">Where to store the N2KHAB input data sources</a>
    </li>
    <li>
      <a href="../articles/v022_example.html">Demonstrating package &amp; data setup and handling of sf objects: a case with read_soilmap()</a>
    </li>
    <li>
      <a href="../articles/v025_geospatial_hab.html">Working with geospatial data sources of habitat (sub)types and RIBs</a>
    </li>
    <li>
      <a href="../articles/v030_GRTSmh.html">Using the GRTS data sources</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/inbo/n2khab/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v025_geospatial_hab_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with geospatial data sources of habitat (sub)types and RIBs</h1>
                        <h4 class="author">Floris Vanderhaeghe, Toon Westra, Jan Wouters</h4>
            
            <h4 class="date">2020-10-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/inbo/n2khab/blob/master/vignettes/v025_geospatial_hab.Rmd"><code>vignettes/v025_geospatial_hab.Rmd</code></a></small>
      <div class="hidden name"><code>v025_geospatial_hab.Rmd</code></div>

    </div>

    
    
<p><em>General note: the below vignette contains frozen output of 16 Oct 2020.</em> <em>This makes it possible to build the package with vignettes without access to the data sources.</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://inbo.github.io/n2khab">n2khab</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-quantities/units/">units</a></span><span class="op">)</span></code></pre></div>
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h2>
<p>This vignette learns you:</p>
<ul>
<li>the difference between various geospatial N2KHAB data sources on the occurrence of types in Flanders (types being habitat (sub)types or regionally important biotopes (RIBs); see <code><a href="../reference/read_types.html">read_types()</a></code>);</li>
<li>how to load these data sources into R;</li>
<li>how to optimally match an interpreted data source with a ‘types’ column in your own dataframe.</li>
</ul>
</div>
<div id="data-sources" class="section level2">
<h2 class="hasAnchor">
<a href="#data-sources" class="anchor"></a>Data sources</h2>
<p>The below N2KHAB data sources are available. For practical information on data storage and locations, see <code><a href="../articles/v020_datastorage.html">vignette("v020_datastorage")</a></code>.</p>
<ul>
<li>
<strong>raw data sources</strong>:
<ul>
<li>
<strong><code>habitatmap</code></strong> (<a href="https://doi.org/10.5281/zenodo.3354381">Zenodo-link</a>): geospatial polygons of BWK and Natura 2000 habitat types in the Flemish Region, originally published by the Research Institute for Nature and Forest (INBO) <span class="citation">(De Saeger et al. 2018)</span> and distributed by ‘Informatie Vlaanderen’.</li>
<li>
<strong><code>habitatstreams</code></strong> (<a href="https://doi.org/10.5281/zenodo.3386245">Zenodo-link</a>): geospatial lines of the Natura 2000 habitat type <code>3260</code> that correspond with its presence in streaming water segments in the Flemish Region, originally published by INBO <span class="citation">(Leyssen, Denys, and De Saeger 2018)</span> and distributed by ‘Informatie Vlaanderen’.</li>
<li>
<strong><code>habitatsprings</code></strong> (<a href="https://doi.org/10.5281/zenodo.3550994">Zenodo-link</a>): geospatial points hat correspond with the presence or absence of the Natura 2000 habitat type <code>7220</code> in springs and streaming water segments in the Flemish Region. The data source is produced, owned and administered by INBO.</li>
<li>
<strong><code>habitatquarries</code></strong> (<a href="https://doi.org/10.5281/zenodo.4072967">Zenodo-link</a>): geospatial polygons that correspond with the presence or absence of the Natura 2000 habitat type <code>8310</code> in underground marl quarries in the Flemish Region (and border areas). The data source is produced, owned and administered by INBO.</li>
</ul>
</li>
<li>
<strong>processed data sources</strong>:
<ul>
<li>
<strong><code>habitatmap_stdized</code></strong> (<a href="https://doi.org/10.5281/zenodo.3355192">Zenodo-link</a>): derived from <code>habitatmap</code>. This datasource only contains polygons with habitat (sub)type or RIB codes. All codes conform to the <code>types</code> reference list (see <code><a href="../reference/read_types.html">read_types()</a></code>). The datasource is a GeoPackage with essentially two objects: 1) the geospatial polygons; 2) a long-formatted table with the associated types (multiple records can occur per <code>polygon_id</code>). For more details see <code><a href="../reference/read_habitatmap_stdized.html">read_habitatmap_stdized()</a></code>.</li>
<li>
<strong><code>habitatmap_terr</code></strong> (<a href="https://doi.org/10.5281/zenodo.3468948">Zenodo-link</a>): the further interpreted, terrestrial part of <code>habitatmap_stdized</code> (‘terrestrial’ includes ‘semi-terrestrial’). Amongst other properties, it excludes polygons <em>without</em> terrestrial types, it excludes rows which most probably are no habitat or RIB at all, and several main type codes were translated to a corresponding subtype which they almost always represent. The datasource is a GeoPackage, organized in the same way as <code>habitatmap_stdized</code>. For more details see <code><a href="../reference/read_habitatmap_terr.html">read_habitatmap_terr()</a></code>.</li>
<li>
<strong><code>watersurfaces_hab</code></strong> (<a href="https://doi.org/10.5281/zenodo.3374645">Zenodo-link</a>): a combination of the environmental data source <code>watersurfaces</code> (<span class="citation">Packet et al. (2018)</span>; see <code><a href="../reference/read_watersurfaces.html">read_watersurfaces()</a></code>) and the above data source <code>habitatmap_stdized</code>. It represents polygons (from <code>watersurfaces</code> or <code>habitatmap_stdized</code>) that completely or partly contain standing water habitat types or RIBs (i.e. <code>2190_a</code>, ‘<code>31..</code>’ types or <code>rbbah</code>; types <code>3260</code> and <code>7220</code> are not included). The datasource is a GeoPackage, organized in the same way as <code>habitatmap_stdized</code>. For more details see <code><a href="../reference/read_watersurfaces_hab.html">read_watersurfaces_hab()</a></code>.</li>
</ul>
</li>
</ul>
</div>
<div id="using-the-read_----functions" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-read_----functions" class="anchor"></a>Using the <code>read_...()</code> functions</h2>
<p>In the below R code, it is supposed that a <code>n2khab_data</code> folder is present in your working directory or a directory up to 10 levels higher, with the relevant data sources in the right place. See <code><a href="../articles/v020_datastorage.html">vignette("v020_datastorage")</a></code> for the setup.</p>
<p>The advantage of using the <code>read_...()</code> functions is the uniform approach to read the above data sources in R, enhancing collaboration and speeding up your work.</p>
<ul>
<li>Geospatial layers are represented as an <code>sf</code> object, in the coordinate reference system (CRS) ‘Belge 1972 / Belgian Lambert 72’ (EPSG-code <a href="https://epsg.io/31370">31370</a>).</li>
<li>Dataframes are presented as tibbles.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</li>
<li>English &amp; <a href="https://style.tidyverse.org/">tidyverse-styled</a> names of variables stimulate you to always produce internationalized code, tables and figures.</li>
<li>The <code>type</code> variable (if present) is a factor with the same levels as the <code>type</code> variable of the <code>types</code> reference list (see <code><a href="../reference/read_types.html">read_types()</a></code>).</li>
<li>Some variables may be discarded that should normally have no added value, e.g. values that duplicate already existing information.</li>
</ul>
<div id="returning-raw-data-sources" class="section level3">
<h3 class="hasAnchor">
<a href="#returning-raw-data-sources" class="anchor"></a>Returning raw data sources</h3>
<p>The functions do just basic preprocessing, in order to return (by default) an object that well reflects the structure of the raw data source and returns all its records.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatmap.html">read_habitatmap</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">habitatmap</span>
<span class="co">#&gt; Simple feature collection with 618147 features and 30 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 21991.38 ymin: 153058.3 xmax: 258871.8 ymax: 244027.3</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 618,147 x 31</span>
<span class="co">#&gt;    polygon_id eval  eenh1 eenh2 eenh3 eenh4 eenh5 eenh6 eenh7 eenh8 v1    v2   </span>
<span class="co">#&gt;  * &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1 000098_v2… m     b     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  2 000132_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  3 000135_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  4 000136_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  5 000142_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  6 000150_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  7 000152_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  8 000154_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt;  9 000297_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 10 000805_v2… m     bl    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; # … with 618,137 more rows, and 19 more variables: v3 &lt;chr&gt;, source &lt;chr&gt;,</span>
<span class="co">#&gt; #   info &lt;chr&gt;, bwk_label &lt;chr&gt;, hab1 &lt;chr&gt;, phab1 &lt;int&gt;, hab2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   phab2 &lt;int&gt;, hab3 &lt;chr&gt;, phab3 &lt;int&gt;, hab4 &lt;chr&gt;, phab4 &lt;int&gt;, hab5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   phab5 &lt;int&gt;, source_hab &lt;chr&gt;, source_phab &lt;chr&gt;, hab_legend &lt;fct&gt;,</span>
<span class="co">#&gt; #   area_m2 &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;</span></code></pre></div>
<p>The <code>habitatmap</code> object is a very wide dataframe which is not so easy to handle in R. For analytical work on habitat types and RIBs, you’re advised to use the tidied data source <code>habitatmap_stdized</code>; see <a href="#processed-data-sources">below</a>.</p>
<p><code><a href="../reference/read_habitatmap.html">read_habitatmap(filter_hab = TRUE)</a></code> will only retain the polygons that occur in <code>habitatmap_stdized</code>, i.e. those that contain habitat types or RIBs.</p>
<p>The data sources <code>habitatstreams</code>, <code>habitatsprings</code> and <code>habitatquarries</code> have a straightforward data structure. There was no need to generate derived data sources. The meaning of their columns is described in the function documentation. Not all function arguments are discussed in this vignette: do take the time to look at the documentation!</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatstreams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatstreams.html">read_habitatstreams</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">habitatstreams</span>
<span class="co">#&gt; Simple feature collection with 560 features and 3 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 33097.92 ymin: 157529.6 xmax: 254039 ymax: 243444.6</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 560 x 4</span>
<span class="co">#&gt;    river_name   source_id type                                          geometry</span>
<span class="co">#&gt;    &lt;fct&gt;        &lt;fct&gt;     &lt;fct&gt;                                 &lt;LINESTRING [m]&gt;</span>
<span class="co">#&gt;  1 WOLFPUTBEEK  VMM       3260  (127857.1 167681.2, 127854.9 167684.5, 127844 1…</span>
<span class="co">#&gt;  2 OUDE KALE    VMM       3260  (95737.01 196912.9, 95732.82 196912.4, 95710.38…</span>
<span class="co">#&gt;  3 VENLOOP      EcoInv    3260  (169352.7 209314.9, 169358.8 209290.5, 169326.2…</span>
<span class="co">#&gt;  4 VENLOOP      EcoInv    3260  (169633.6 209293.5, 169625 209289.2, 169594.4 2…</span>
<span class="co">#&gt;  5 KLEINE NETE  EcoInv    3260  (181087.1 208607.2, 181088.6 208608.1, 181089 2…</span>
<span class="co">#&gt;  6 KLEINE NETE  EcoInv    3260  (180037.4 208360.4, 180038.3 208377.5, 180038.3…</span>
<span class="co">#&gt;  7 KLEINE NETE  EcoInv    3260  (180520 208595.7, 180540.5 208607.4, 180541.2 2…</span>
<span class="co">#&gt;  8 KLEINE NETE  EcoInv    3260  (187379.9 209998.8, 187381.3 209998.5, 187381.6…</span>
<span class="co">#&gt;  9 RAAMDONKSEB… extrapol  3260  (183545.5 192409, 183541.9 192406.7, 183541.9 1…</span>
<span class="co">#&gt; 10 KLEINE NETE  EcoInv    3260  (183516.4 208261.7, 183567.3 208279.2, 183567.3…</span>
<span class="co">#&gt; # … with 550 more rows</span></code></pre></div>
<p>With <code><a href="../reference/read_habitatstreams.html">read_habitatstreams(source_text = TRUE)</a></code> a second object <code>sources</code> is returned with the meaning of the <code>source_id</code> codes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_habitatstreams.html">read_habitatstreams</a></span><span class="op">(</span>source_text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">.</span><span class="op">$</span><span class="va">sources</span>
<span class="co">#&gt; # A tibble: 7 x 2</span>
<span class="co">#&gt;   source_id          source_text                                                </span>
<span class="co">#&gt;   &lt;fct&gt;              &lt;fct&gt;                                                      </span>
<span class="co">#&gt; 1 VMM                "Gegevens afgeleid van macrofyteninventarisaties uitgevoer…</span>
<span class="co">#&gt; 2 EcoInv             "Tijdens ecologische inventarisatiestudies uitgevoerd in o…</span>
<span class="co">#&gt; 3 extrapol           "De conclusie van het nabijgelegen geïnventariseerde segme…</span>
<span class="co">#&gt; 4 Van Belleghem (20… "Macrofytengegevens afgeleid van Van Belleghem S., Bal K.,…</span>
<span class="co">#&gt; 5 Leyssen ea (2005)  "Macrofytengegevens afgeleid van Leyssen A., Adriaens P., …</span>
<span class="co">#&gt; 6 WrnBe              "Waarnemingen afkomstig van Waarnemingen.be, de website vo…</span>
<span class="co">#&gt; 7 INBO               "Tijdens veldbezoeken werd de aan- of afwezigheid van het …</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatsprings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatsprings.html">read_habitatsprings</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">habitatsprings</span>
<span class="co">#&gt; Simple feature collection with 104 features and 11 fields</span>
<span class="co">#&gt; geometry type:  POINT</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 36407.89 ymin: 155249.7 xmax: 258371.1 ymax: 179732</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 104 x 12</span>
<span class="co">#&gt;    point_id name  system_type code_orig type  certain unit_id area_m2  year</span>
<span class="co">#&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt;       &lt;chr&gt;     &lt;fct&gt; &lt;lgl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1        1 Stee… rivulet     7220      7220  TRUE          1      50  2014</span>
<span class="co">#&gt;  2        2 Stee… rivulet     7220      7220  TRUE          1      20  2014</span>
<span class="co">#&gt;  3        3 Duli… &lt;NA&gt;        7230      7230  TRUE         NA      NA  2014</span>
<span class="co">#&gt;  4        4 Kapi… &lt;NA&gt;        gh        &lt;NA&gt;  TRUE         NA      NA  2014</span>
<span class="co">#&gt;  5        5 Reme… rivulet     7220      7220  TRUE          2     200  2014</span>
<span class="co">#&gt;  6        6 Reme… rivulet     7220      7220  TRUE          2     500  2014</span>
<span class="co">#&gt;  7        7 Kest… unknown     7220,gh   7220  FALSE        32      NA    NA</span>
<span class="co">#&gt;  8        8 Krin… rivulet     7220      7220  TRUE          3     800  2014</span>
<span class="co">#&gt;  9        9 Bois… rivulet     7220      7220  TRUE          4      50  2014</span>
<span class="co">#&gt; 10       10 Kwin… mire        7220      7220  TRUE          5      10  2014</span>
<span class="co">#&gt; # … with 94 more rows, and 3 more variables: in_sac &lt;lgl&gt;, source &lt;chr&gt;,</span>
<span class="co">#&gt; #   geometry &lt;POINT [m]&gt;</span></code></pre></div>
<p>Do note that both the <code>habitatsprings</code> and <code>habitatquarries</code> data sources also contain records which are no habitat type. You can filter the habitat types by setting the <code>filter_hab</code> argument as <code>TRUE</code> (not shown).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatquarries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatquarries.html">read_habitatquarries</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">habitatquarries</span>
<span class="co">#&gt; Simple feature collection with 45 features and 6 fields</span>
<span class="co">#&gt; geometry type:  POLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 221427.3 ymin: 160393.5 xmax: 243211.1 ymax: 168965.1</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 45 x 7</span>
<span class="co">#&gt;    polygon_id unit_id name  code_orig type  extra_reference</span>
<span class="co">#&gt;         &lt;int&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;fct&gt; &lt;fct&gt;          </span>
<span class="co">#&gt;  1          4       4 Aver… gh        &lt;NA&gt;  Lahaye 2018    </span>
<span class="co">#&gt;  2          6       6 Aver… 8310      8310  Lahaye 2018    </span>
<span class="co">#&gt;  3          5       5 Aver… gh        &lt;NA&gt;  Lahaye 2018    </span>
<span class="co">#&gt;  4         20      20 Cool… 8310      8310  Limburgs Lands…</span>
<span class="co">#&gt;  5         21      21 Cool… gh        &lt;NA&gt;  Limburgs Lands…</span>
<span class="co">#&gt;  6         29      29 Groe… 8310      8310  &lt;NA&gt;           </span>
<span class="co">#&gt;  7         31      31 Grot… 8310      8310  De Haan &amp; Laha…</span>
<span class="co">#&gt;  8         37      37 Grot… 8310      8310  De Haan &amp; Laha…</span>
<span class="co">#&gt;  9         24      24 Heni… 8310      8310  Dusar et al. 2…</span>
<span class="co">#&gt; 10         34      34 Heni… 8310      8310  Dusar et al. 2…</span>
<span class="co">#&gt; # … with 35 more rows, and 1 more variable: geom &lt;POLYGON [m]&gt;</span></code></pre></div>
<p>The habitatquarries data source also includes the literature references. These can be added as a second dataframe – in that case a list is returned:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatquarries2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatquarries.html">read_habitatquarries</a></span><span class="op">(</span>references <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">habitatquarries2</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">habitatquarries2</span><span class="op">)</span>
<span class="co">#&gt; [1] "habitatquarries"  "extra_references"</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">habitatquarries</span>, <span class="va">habitatquarries2</span><span class="op">$</span><span class="va">habitatquarries</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">habitatquarries2</span><span class="op">$</span><span class="va">extra_references</span>
<span class="co">#&gt; # A tibble: 9 x 23</span>
<span class="co">#&gt;   category bibtexkey address author booktitle journal month note  number pages</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;</span>
<span class="co">#&gt; 1 BOOK     de_haan_… Brusse… De Ha… &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt; </span>
<span class="co">#&gt; 2 INCOLLE… dusar_me… Genk    Dusar… Likona j… &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   6-13 </span>
<span class="co">#&gt; 3 BOOK     jenneken… Riemst  Jenne… &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt; </span>
<span class="co">#&gt; 4 INCOLLE… lahaye_g… Riemst  Lahay… &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   12   </span>
<span class="co">#&gt; 5 BOOK     verhoeve… Weert   Verho… &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  1769   &lt;NA&gt; </span>
<span class="co">#&gt; 6 BOOK     walschot… &lt;NA&gt;    Walsc… &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt; </span>
<span class="co">#&gt; 7 MISC     wikipedi… &lt;NA&gt;    {Wiki… &lt;NA&gt;      &lt;NA&gt;    jan   Page… &lt;NA&gt;   &lt;NA&gt; </span>
<span class="co">#&gt; 8 MISC     limburgs… &lt;NA&gt;    {Limb… &lt;NA&gt;      &lt;NA&gt;    apr   Libr… &lt;NA&gt;   &lt;NA&gt; </span>
<span class="co">#&gt; 9 ARTICLE  silverta… &lt;NA&gt;    Silve… &lt;NA&gt;      Natuur… &lt;NA&gt;  &lt;NA&gt;  12     334-…</span>
<span class="co">#&gt; # … with 13 more variables: publisher &lt;chr&gt;, series &lt;chr&gt;, title &lt;chr&gt;,</span>
<span class="co">#&gt; #   volume &lt;chr&gt;, year &lt;dbl&gt;, url &lt;chr&gt;, isbn &lt;chr&gt;, copyright &lt;chr&gt;,</span>
<span class="co">#&gt; #   abstract &lt;chr&gt;, language &lt;chr&gt;, urldate &lt;chr&gt;, issn &lt;chr&gt;, keywords &lt;chr&gt;</span></code></pre></div>
<p>These extra references can also be printed to the R console in BibTeX format, when specifying <code>bibtex = TRUE</code>.</p>
</div>
<div id="returning-processed-data-sources" class="section level3">
<h3 class="hasAnchor">
<a href="#returning-processed-data-sources" class="anchor"></a>Returning processed data sources</h3>
<p>The reading functions for the three processed data sources will always return a <strong>list</strong>:</p>
<ul>
<li>the first element holds the geospatial information as an <strong>sf object</strong>. It has unique feature IDs that can be joined with rows of the second element;</li>
<li>the second element is a <strong>tibble</strong> that presents attributes of the features as <em><strong><a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy</a> data</strong></em>.</li>
</ul>
<p>Let’s see how this works!</p>
<div id="read_habitatmap_stdized" class="section level4">
<h4 class="hasAnchor">
<a href="#read_habitatmap_stdized" class="anchor"></a>read_habitatmap_stdized()</h4>
<p>A tidy representation of the <code>habitatmap</code> data, restricted to the polygons that contain habitat types or RIBs, is returned by <code><a href="../reference/read_habitatmap_stdized.html">read_habitatmap_stdized()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatmap_stdized.html">read_habitatmap_stdized</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hms_pol</span> <span class="op">&lt;-</span> <span class="va">hms</span><span class="op">$</span><span class="va">habitatmap_polygons</span>
<span class="va">hms_pol</span>
<span class="co">#&gt; Simple feature collection with 77048 features and 2 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 22003.2 ymin: 153084.4 xmax: 258871.8 ymax: 243351.8</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 77,048 x 3</span>
<span class="co">#&gt;    polygon_id  description_orig                                             geom</span>
<span class="co">#&gt;  * &lt;fct&gt;       &lt;chr&gt;                                          &lt;MULTIPOLYGON [m]&gt;</span>
<span class="co">#&gt;  1 129420_v20… 60% x; 40% 6430_hf (((242838.5 161337.3, 242842.8 161324.7, 2428…</span>
<span class="co">#&gt;  2 130153_v20… 70% 9120_qb; 30% … (((150669.4 227248.6, 150668.1 227242.9, 1505…</span>
<span class="co">#&gt;  3 130815_v20… 70% gh; 30% 9160   (((258338.4 158696.1, 258336.5 158693.5, 2583…</span>
<span class="co">#&gt;  4 137826_v20… 100% 6430,rbbhf    (((181587.2 234938, 181613.1 234933.1, 181646…</span>
<span class="co">#&gt;  5 170624_v20… 100% rbbmr         (((145876.8 229686.8, 145701.7 229680.6, 1456…</span>
<span class="co">#&gt;  6 203261_v20… 70% gh; 30% rbbmr  (((117137.2 210307.9, 117136.3 210288.3, 1171…</span>
<span class="co">#&gt;  7 204352_v20… 80% gh; 20% rbbsp  (((116357.3 159278.3, 116340.5 159259.8, 1163…</span>
<span class="co">#&gt;  8 204376_v20… 90% gh; 10% rbbsg  (((116110.1 210545.5, 116102.4 210541.1, 1160…</span>
<span class="co">#&gt;  9 205188_v20… 60% rbbsp; 40% gh  (((232114.7 161594.5, 232122.7 161590.5, 2321…</span>
<span class="co">#&gt; 10 205291_v20… 70% gh; 30% rbbsp  (((191253.5 160641.5, 191254.8 160636.1, 1912…</span>
<span class="co">#&gt; # … with 77,038 more rows</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hms_occ</span> <span class="op">&lt;-</span> <span class="va">hms</span><span class="op">$</span><span class="va">habitatmap_types</span>
<span class="va">hms_occ</span>
<span class="co">#&gt; # A tibble: 98,737 x 5</span>
<span class="co">#&gt;    polygon_id   code_orig  phab certain type    </span>
<span class="co">#&gt;    &lt;fct&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;lgl&gt;   &lt;fct&gt;   </span>
<span class="co">#&gt;  1 000038_v2016 91E0_va     100 TRUE    91E0_va </span>
<span class="co">#&gt;  2 000043_v2016 9130_end    100 TRUE    9130_end</span>
<span class="co">#&gt;  3 000132_v2016 9130_end    100 TRUE    9130_end</span>
<span class="co">#&gt;  4 000204_v2016 91E0_vn     100 TRUE    91E0_vn </span>
<span class="co">#&gt;  5 000255_v2016 91E0_vc     100 TRUE    91E0_vc </span>
<span class="co">#&gt;  6 000297_v2016 rbbsp        10 TRUE    rbbsp   </span>
<span class="co">#&gt;  7 000311_v2016 9130_end     70 TRUE    9130_end</span>
<span class="co">#&gt;  8 000311_v2016 rbbsp        30 TRUE    rbbsp   </span>
<span class="co">#&gt;  9 000390_v2016 91E0_vn      70 TRUE    91E0_vn </span>
<span class="co">#&gt; 10 000390_v2016 91E0_va      30 TRUE    91E0_va </span>
<span class="co">#&gt; # … with 98,727 more rows</span></code></pre></div>
<p>Let’s estimate the surface area per type, including uncertain occurrences of types and taking into account cover percentage per polygon (<code>phab</code>):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hms_pol</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">st_drop_geometry</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">hms_occ</span>, by <span class="op">=</span> <span class="st">"polygon_id"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="co"># area of type within polygon:</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>area_type <span class="op">=</span> <span class="va">area</span> <span class="op">*</span> <span class="va">phab</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">area_type</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu"><a href="https://rdrr.io/pkg/units/man/set_units.html">set_units</a></span><span class="op">(</span><span class="st">"ha"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
            <span class="op">)</span>
<span class="co">#&gt; # A tibble: 101 x 2</span>
<span class="co">#&gt;    type        area</span>
<span class="co">#&gt;    &lt;fct&gt;       [ha]</span>
<span class="co">#&gt;  1 1130     5353.85</span>
<span class="co">#&gt;  2 1140     2096.20</span>
<span class="co">#&gt;  3 1310_pol   17.39</span>
<span class="co">#&gt;  4 1310_zk    43.08</span>
<span class="co">#&gt;  5 1310_zv    10.62</span>
<span class="co">#&gt;  6 1320        1.55</span>
<span class="co">#&gt;  7 1330_da   110.23</span>
<span class="co">#&gt;  8 1330_hpr  136.40</span>
<span class="co">#&gt;  9 2110       26.84</span>
<span class="co">#&gt; 10 2120      481.62</span>
<span class="co">#&gt; # … with 91 more rows</span></code></pre></div>
</div>
<div id="read_habitatmap_terr" class="section level4">
<h4 class="hasAnchor">
<a href="#read_habitatmap_terr" class="anchor"></a>read_habitatmap_terr()</h4>
<p><code><a href="../reference/read_habitatmap_terr.html">read_habitatmap_terr()</a></code> behaves exactly the same way:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_habitatmap_terr.html">read_habitatmap_terr</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_polygons</span>
<span class="co">#&gt; Simple feature collection with 68300 features and 4 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 22003.2 ymin: 153084.4 xmax: 258871.8 ymax: 243351.8</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 68,300 x 5</span>
<span class="co">#&gt;    polygon_id  description_orig  description source                         geom</span>
<span class="co">#&gt;  * &lt;fct&gt;       &lt;chr&gt;             &lt;chr&gt;       &lt;fct&gt;            &lt;MULTIPOLYGON [m]&gt;</span>
<span class="co">#&gt;  1 129420_v20… 60% x; 40% 6430_… 60% x; 40%… habita… (((242838.5 161337.3, 2428…</span>
<span class="co">#&gt;  2 130153_v20… 70% 9120_qb; 30%… 70% 9120_q… habita… (((150669.4 227248.6, 1506…</span>
<span class="co">#&gt;  3 130815_v20… 70% gh; 30% 9160  70% gh; 30… habita… (((258338.4 158696.1, 2583…</span>
<span class="co">#&gt;  4 137826_v20… 100% 6430,rbbhf   100% 6430_… habita… (((181587.2 234938, 181613…</span>
<span class="co">#&gt;  5 170624_v20… 100% rbbmr        100% rbbmr  habita… (((145876.8 229686.8, 1457…</span>
<span class="co">#&gt;  6 203261_v20… 70% gh; 30% rbbmr 70% gh; 30… habita… (((117137.2 210307.9, 1171…</span>
<span class="co">#&gt;  7 204352_v20… 80% gh; 20% rbbsp 80% gh; 20… habita… (((116357.3 159278.3, 1163…</span>
<span class="co">#&gt;  8 204376_v20… 90% gh; 10% rbbsg 90% gh; 10… habita… (((116110.1 210545.5, 1161…</span>
<span class="co">#&gt;  9 205188_v20… 60% rbbsp; 40% gh 60% rbbsp;… habita… (((232114.7 161594.5, 2321…</span>
<span class="co">#&gt; 10 205291_v20… 70% gh; 30% rbbsp 70% gh; 30… habita… (((191253.5 160641.5, 1912…</span>
<span class="co">#&gt; # … with 68,290 more rows</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_types</span>
<span class="co">#&gt; # A tibble: 87,473 x 6</span>
<span class="co">#&gt;    polygon_id   code_orig  phab certain type     source            </span>
<span class="co">#&gt;    &lt;fct&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;lgl&gt;   &lt;fct&gt;    &lt;fct&gt;             </span>
<span class="co">#&gt;  1 000038_v2016 91E0_va     100 TRUE    91E0_va  habitatmap_stdized</span>
<span class="co">#&gt;  2 000043_v2016 9130_end    100 TRUE    9130_end habitatmap_stdized</span>
<span class="co">#&gt;  3 000132_v2016 9130_end    100 TRUE    9130_end habitatmap_stdized</span>
<span class="co">#&gt;  4 000204_v2016 91E0_vn     100 TRUE    91E0_vn  habitatmap_stdized</span>
<span class="co">#&gt;  5 000255_v2016 91E0_vc     100 TRUE    91E0_vc  habitatmap_stdized</span>
<span class="co">#&gt;  6 000297_v2016 rbbsp        10 TRUE    rbbsp    habitatmap_stdized</span>
<span class="co">#&gt;  7 000311_v2016 9130_end     70 TRUE    9130_end habitatmap_stdized</span>
<span class="co">#&gt;  8 000311_v2016 rbbsp        30 TRUE    rbbsp    habitatmap_stdized</span>
<span class="co">#&gt;  9 000390_v2016 91E0_vn      70 TRUE    91E0_vn  habitatmap_stdized</span>
<span class="co">#&gt; 10 000390_v2016 91E0_va      30 TRUE    91E0_va  habitatmap_stdized</span>
<span class="co">#&gt; # … with 87,463 more rows</span></code></pre></div>
<p>Compared to <code>habitatmap_stdized</code>, <em>purely</em> aquatic or non-habitat/RIB polygons were omitted, and a part of the type data were interpreted in a more specific way. Further, while type <code>7220</code> is present in <code>habitatmap_terr</code>, the <code><a href="../reference/read_habitatmap_terr.html">read_habitatmap_terr()</a></code> function drops it by default because the <code>habitatsprings</code> data source is recommended for that. This can be controlled by the <code>drop_7220</code> argument.</p>
<p>As a consequence, some type codes are completely absent from <code>habitatmap_terr_types</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hms_occ</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_types</span> <span class="op">%&gt;%</span> 
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span>, 
            by <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 8 x 1</span>
<span class="co">#&gt;   type </span>
<span class="co">#&gt;   &lt;fct&gt;</span>
<span class="co">#&gt; 1 2190 </span>
<span class="co">#&gt; 2 3110 </span>
<span class="co">#&gt; 3 6410 </span>
<span class="co">#&gt; 4 6430 </span>
<span class="co">#&gt; 5 6510 </span>
<span class="co">#&gt; 6 7140 </span>
<span class="co">#&gt; 7 7220 </span>
<span class="co">#&gt; 8 9130</span></code></pre></div>
<p>About 4% of all type occurrences received a new type code:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_types</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pct <span class="op">=</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   source                                  n   pct</span>
<span class="co">#&gt;   &lt;fct&gt;                               &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 habitatmap_stdized                  83627    96</span>
<span class="co">#&gt; 2 habitatmap_stdized + interpretation  3846     4</span></code></pre></div>
</div>
<div id="read_watersurfaces_hab" class="section level4">
<h4 class="hasAnchor">
<a href="#read_watersurfaces_hab" class="anchor"></a>read_watersurfaces_hab()</h4>
<p>A similar story, this time for polygons that (could) have aquatic types:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wsh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_watersurfaces_hab.html">read_watersurfaces_hab</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wsh</span><span class="op">$</span><span class="va">watersurfaces_polygons</span>
<span class="co">#&gt; Simple feature collection with 2947 features and 4 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 22546.57 ymin: 159273.1 xmax: 253928.1 ymax: 242960.1</span>
<span class="co">#&gt; projected CRS:  Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; # A tibble: 2,947 x 5</span>
<span class="co">#&gt;    polygon_id polygon_id_ws polygon_id_habi… description_orig</span>
<span class="co">#&gt;  * &lt;fct&gt;      &lt;fct&gt;         &lt;fct&gt;            &lt;chr&gt;           </span>
<span class="co">#&gt;  1 ANTANT0082 ANTANT0082    596466_v2014     60% 3150; 20% r…</span>
<span class="co">#&gt;  2 ANTANT0251 ANTANT0251    113978_v2014     100% 3150       </span>
<span class="co">#&gt;  3 ANTANT0253 ANTANT0253    111606_v2014     100% 3150       </span>
<span class="co">#&gt;  4 ANTANT0297 ANTANT0297    409153_v2014+40… 85% 3140; 15% 3…</span>
<span class="co">#&gt;  5 ANTANT0315 ANTANT0315    519082_v2018     100% 3140       </span>
<span class="co">#&gt;  6 ANTANT0319 ANTANT0319    601958_v2014     100% 3150,gh    </span>
<span class="co">#&gt;  7 ANTANT0381 ANTANT0381    644003_v2014     85% gh; 15% 3140</span>
<span class="co">#&gt;  8 ANTANT0383 ANTANT0383    631879_v2014+59… 50% 3150; 40% r…</span>
<span class="co">#&gt;  9 ANTANT0384 ANTANT0384    644003_v2014     85% gh; 15% 3140</span>
<span class="co">#&gt; 10 ANTANT0434 ANTANT0434    537902_v2018     100% 3140       </span>
<span class="co">#&gt; # … with 2,937 more rows, and 1 more variable: geom &lt;MULTIPOLYGON [m]&gt;</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wsh</span><span class="op">$</span><span class="va">watersurfaces_types</span>
<span class="co">#&gt; # A tibble: 3,302 x 4</span>
<span class="co">#&gt;    polygon_id code_orig certain type </span>
<span class="co">#&gt;    &lt;fct&gt;      &lt;chr&gt;     &lt;lgl&gt;   &lt;fct&gt;</span>
<span class="co">#&gt;  1 ANTANT0082 3150      TRUE    3150 </span>
<span class="co">#&gt;  2 ANTANT0251 3150      TRUE    3150 </span>
<span class="co">#&gt;  3 ANTANT0253 3150      TRUE    3150 </span>
<span class="co">#&gt;  4 ANTANT0297 3140      TRUE    3140 </span>
<span class="co">#&gt;  5 ANTANT0297 3150      TRUE    3150 </span>
<span class="co">#&gt;  6 ANTANT0315 3140      TRUE    3140 </span>
<span class="co">#&gt;  7 ANTANT0319 3150,gh   FALSE   3150 </span>
<span class="co">#&gt;  8 ANTANT0381 3140      TRUE    3140 </span>
<span class="co">#&gt;  9 ANTANT0383 3150      TRUE    3150 </span>
<span class="co">#&gt; 10 ANTANT0384 3140      TRUE    3140 </span>
<span class="co">#&gt; # … with 3,292 more rows</span></code></pre></div>
<p>Let’s compute some statistics of standing water types (ignoring the value <code>certain</code>):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wsh</span><span class="op">$</span><span class="va">watersurfaces_polygons</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">st_drop_geometry</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">wsh</span><span class="op">$</span><span class="va">watersurfaces_types</span>,
             by <span class="op">=</span> <span class="st">"polygon_id"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>nr_watersurfaces <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">polygon_id</span><span class="op">)</span>,
            total_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>,
            area_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>,
            area_Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">area</span>, <span class="fl">0.25</span><span class="op">)</span>,
            area_Q2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">area</span>, <span class="fl">0.5</span><span class="op">)</span>,
            area_Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">area</span>, <span class="fl">0.75</span><span class="op">)</span>,
            max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>
            <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"area|max"</span><span class="op">)</span><span class="op">)</span>, 
            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/set_units.html">set_units</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"a"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 8</span>
<span class="co">#&gt;   type     nr_watersurfaces total_area area_min area_Q1 area_Q2 area_Q3     max</span>
<span class="co">#&gt;   &lt;fct&gt;               &lt;int&gt;        [a]      [a]     [a]     [a]     [a]     [a]</span>
<span class="co">#&gt; 1 2190_a                308     3547.4      0.0     0.9     2.0     5.6   317.5</span>
<span class="co">#&gt; 2 3110                    5     1642.6    111.7   119.8   199.5   362.3   849.3</span>
<span class="co">#&gt; 3 3130                  271    37433.4      0.8    11.1    36.2   124.3  2807.2</span>
<span class="co">#&gt; 4 3130_aom             1022    88380.7      0.1     2.1     9.0    43.1  7062.7</span>
<span class="co">#&gt; 5 3130_na               226    85942.7      0.6    37.6   111.9   266.5 13668.2</span>
<span class="co">#&gt; 6 3140                  105    66531.9      0.8    11.8    46.6   230.4 13668.2</span>
<span class="co">#&gt; 7 3150                  500   113617.5      0.1     6.4    17.1    86.5 13668.2</span>
<span class="co">#&gt; 8 3160                  297    25137.0      0.1     6.4    21.8    64.3  4179.1</span>
<span class="co">#&gt; 9 rbbah                 528    40830.2      0.1     4.2    12.8    55.2  3748.6</span></code></pre></div>
<p>An strong point of <code>sf</code> objects is that the geometry has explicit units. Consequently we can make use of tools like <code><a href="https://rdrr.io/pkg/units/man/set_units.html">set_units()</a></code> to convert units (e.g. surface area as <em>are</em> (a)).</p>
<p>Because the main type code <code>3130</code> will mostly boil down to <code>3130_aom</code> in the field, a further interpreted flavour can be generated with <code><a href="../reference/read_watersurfaces_hab.html">read_watersurfaces_hab(interpreted = TRUE)</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_watersurfaces_hab.html">read_watersurfaces_hab</a></span><span class="op">(</span>interpreted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">.</span><span class="op">$</span><span class="va">watersurfaces_types</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"3130"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">nrow</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
</div>
</div>
</div>
<div id="matching-interpreted-data-sources-with-a-dataframe-column-of-types" class="section level2">
<h2 class="hasAnchor">
<a href="#matching-interpreted-data-sources-with-a-dataframe-column-of-types" class="anchor"></a>Matching interpreted data sources with a dataframe column of types</h2>
<p>The <code><a href="../reference/expand_types.html">expand_types()</a></code> function helps us to join a type column of your own dataframe with the results of <code><a href="../reference/read_habitatmap_terr.html">read_habitatmap_terr()</a></code> or <code><a href="../reference/read_watersurfaces_hab.html">read_watersurfaces_hab()</a></code>.</p>
<p>For both of these datasets, the following conversions of your dataframe are supported in order to create optimal joins:</p>
<ul>
<li>adding extra <em>subtype</em> rows when main type codes occur for which subtypes exist;</li>
<li>adding extra <em>main type</em> rows when certain subtypes of that main type are present (the conditions can be relaxed; see the function documentation). This is supported for 2330, 6230 and 91E0, for which this makes sense with the two mentioned data sources.</li>
</ul>
<p>An example (<code>df</code> is our dataframe):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
        <span class="op">~</span><span class="va">mycode</span>, <span class="op">~</span><span class="va">obs</span>,
        <span class="st">"2130"</span>, <span class="fl">5</span>,
        <span class="st">"2190"</span>, <span class="fl">45</span>,
        <span class="st">"2330_bu"</span>, <span class="fl">8</span>,
        <span class="st">"2330_dw"</span>, <span class="fl">8</span>,
        <span class="st">"6410_mo"</span>, <span class="fl">78</span>,
        <span class="st">"6410_ve"</span>, <span class="fl">4</span>,
        <span class="st">"91E0_vn"</span>, <span class="fl">10</span>
    <span class="op">)</span>
<span class="va">df</span>
<span class="co">#&gt; # A tibble: 7 x 2</span>
<span class="co">#&gt;   mycode    obs</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2130        5</span>
<span class="co">#&gt; 2 2190       45</span>
<span class="co">#&gt; 3 2330_bu     8</span>
<span class="co">#&gt; 4 2330_dw     8</span>
<span class="co">#&gt; 5 6410_mo    78</span>
<span class="co">#&gt; 6 6410_ve     4</span>
<span class="co">#&gt; 7 91E0_vn    10</span></code></pre></div>
<p>With the <code>type_var</code> argument you specify which variable of your dataframe represents type codes:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_exp</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="../reference/expand_types.html">expand_types</a></span><span class="op">(</span><span class="va">df</span>, type_var <span class="op">=</span> <span class="st">"mycode"</span><span class="op">)</span>
<span class="va">df_exp</span>
<span class="co">#&gt; # A tibble: 13 x 2</span>
<span class="co">#&gt;    mycode        obs</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2130            5</span>
<span class="co">#&gt;  2 2190           45</span>
<span class="co">#&gt;  3 2330_bu         8</span>
<span class="co">#&gt;  4 2330_dw         8</span>
<span class="co">#&gt;  5 6410_mo        78</span>
<span class="co">#&gt;  6 6410_ve         4</span>
<span class="co">#&gt;  7 91E0_vn        10</span>
<span class="co">#&gt;  8 2130_had        5</span>
<span class="co">#&gt;  9 2130_hd         5</span>
<span class="co">#&gt; 10 2190_a         45</span>
<span class="co">#&gt; 11 2190_mp        45</span>
<span class="co">#&gt; 12 2190_overig    45</span>
<span class="co">#&gt; 13 2330            8</span></code></pre></div>
<p>More examples and features are explained in the documentation of <code><a href="../reference/expand_types.html">expand_types()</a></code>.</p>
<p>Obviously, more rows of <code>habitatmap_terr</code> will be retained by joining <code>df_exp</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_types</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">df_exp</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mycode"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">nrow</span>
<span class="co">#&gt; [1] 5885</span></code></pre></div>
<p>When joining with <code>df</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmt</span><span class="op">$</span><span class="va">habitatmap_terr_types</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mycode"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">nrow</span>
<span class="co">#&gt; [1] 4447</span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-de_saeger_biologische_2018">
<p>De Saeger, Steven, Robin Guelinckx, Patrik Oosterlynck, Adinda De Bruyn, Klaas Debusschere, Pieter Dhaluin, Rémar Erens, et al. 2018. <em>Biologische Waarderingskaart en Natura 2000 Habitatkaart: Uitgave 2018</em>. Reports of the Research Institute for Nature and Forest. Brussels: Research Institute for Nature and Forest (INBO).</p>
</div>
<div id="ref-leyssen_indicatieve_2018">
<p>Leyssen, An, Luc Denys, and Steven De Saeger. 2018. <em>Indicatieve situering van het Natura 2000 habitattype 3260. Submontane en laaglandrivieren met vegetaties behorend tot het Ranunculion fluitantis en het Callitricho-Batrachion. Uitgave 2018 (versie 1.6).</em> Reports of the Research Institute for Nature and Forest. Brussels: Research Institute for Nature and Forest (INBO).</p>
</div>
<div id="ref-packet_watervlakken_2018">
<p>Packet, Jo, Kevin Scheers, Vincent Smeekens, An Leyssen, Carine Wils, and Luc Denys. 2018. <em>Watervlakken versie 1.0: polygonenkaart van stilstaand water in Vlaanderen: Een nieuw instrument voor onderzoek, water-, milieu- en natuurbeleid</em>. Reports of the Research Institute for Nature and Forest. Brussels: Research Institute for Nature and Forest (INBO).</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>A tibble is a dataframe that makes working in the tidyverse a little <a href="https://r4ds.had.co.nz/tibbles.html">easier</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Floris Vanderhaeghe, Toon Westra, Hans Van Calster.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
